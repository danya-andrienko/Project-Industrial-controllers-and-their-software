# Project Industrial controllers and their software
 Курсовий проект з предмету промислові контролери та їх програмне забезпечення



**Зміст**

Вступ 

1. Оформлення блок-схеми алгоритму управління

2. Вибір конфігурації контролера і схем підключення

2.1 Схема автоматизації 

2.2. Конфігурування МПК і схеми підключення зовнішніх пристроїв

3. Розроблення схеми підключення датчиків, виконавчих механізмів та інших пристроїв 

4. Складання таблиці зовнішніх змінних та наведення конфігурацій каналів


5. Розробка прикладного програмного забезпечення для реалізації алгоритму управління 22

6. Розроблення імітатора об'єкта 

7. Відлагодження програми користувача 

**Вступ**

Невід'ємною частиною сучасного життя людини є інтелектуальні системи та пристрої.

Людство неупинно розвивається, вдосконалює існуючи та створює нові інтелектуальні системи для полегшення свого життя. Виробництво також не лишилося осторонь, наразі складно уявити ручну працю на виробництві. Все більше виробництв стають повністю автоматизованими, участь людини у процесі виробництва лише у вигляді спостерігача за процесом.

Для того, щоб виробництво стало автоматизованим необхідно мати певний пристрій який буде замінювати людину і керувати процесами замість неї. Найчастіше у якості керуючих пристроїв на виробництві використовують мікропроцесорний програмований логічний контролер ПЛК, але для того щоб він запрацював його необхідно запрограмувати.

Програмуванням ПЛК займаються розробники ПЗ для ПЛК. Процес програмування є складним та займає певний обсяг часу, для того щоб запрограмувати ПЛК необхідно досконало знати процес яким він повинен керувати та усі компоненти системи. Саме через це необхідно постійно оновлювати свої знання у даній області адже саме від того як виконана програма залежить чи правильно буде протікати технологічний процес.

**1.Оформлення блок-схеми алгоритму управління**

Алгоритм керування

**ЗАВДАННЯ 18**

![alt text](github.com/danya-andrienko/Project-Industrial-controllers-and-their-software/blob/main/Рисунки/Схема_об'єкта.jpg
![Image alt](https://github.com/danya-andrienko/Project-Industrial-controllers-and-their-software/blob/main/Рисунки/Схема_об'єкта.jpg)
Рис.1.1 – Схема об'єкта управління

1. Після натискання кнопки "ПУСК" відкрити клапан 1.
2. Ємність заповнювати молоком до тих пір, поки не спрацює датчик верхнього рівня, після

чого закрити клапан 1.

1. Відкрити клапан 3 на 50%, дочекатись поки температура в апараті не досягне 150 оС і після

витримки в 5 хвилин перейти до виконання пункту 4.

1. Включити двигуни 1 та 2, відкрити клапани 2 та 4. Під час процесу сушіння температура повітря в апараті повинна становити 175 оС (температура вимірюється термопарою (діапазон 0-200 оС), а регулюється за допомогою аналогового регулятора ).
2. Процес сушки виконувати до тих пір, поки не спрацює датчик нижнього рівня, після чого повторити роботу програми.
3. При аварійній зупинці двигуна 1, відключити двигун 2, закрити клапани 2 та 4, клапан 3 встановити в нульове положення. Відкрити клапан 5 і тримати його відкритим до спрацювання датчика нижнього рівня.

![Image alt](https://github.com/danya-andrienko/Project-Industrial-controllers-and-their-software/blob/main/Рисунки/Блок-схема.jpg)

Рис.1.2 – Блок-схема алгоритму управління

**2.2. Вибір конфігурації контролера і схем підключення**

2.2.1 Схема автоматизації

Програмований логічний контролер ПЛК – це спеціальне електронне, мікропроцесорне устаткування основним призначенням якого є автоматизація технологічних процесів.

При виборі ПЛК потрібно враховувати технічні засоби та регулюючі органи якими потрібно керувати тобто типи сигналів та типи входів і виходів у ПЛК, також потрібно враховувати кількість входів та виходів і їхній тип, протоколи зв'язку та швидкість обміну даних.

Для того, щоб обрати ПЛК спочатку потрібно визначити вимоги яким він повинен відповідати, для цього розглянемо спрощену схему автоматизації, яка зображена на рисунку 2.1.

![Image alt](https://github.com/danya-andrienko/Project-Industrial-controllers-and-their-software/blob/main/Рисунки/ФСА.jpg)

Рис.2.1 – Спрощена схема автоматизації

ВД – входи дискретні; ДВ – виходи дискретні; ВА – входи аналогові; АВ – аналогові виходи; ВІ – входи імпульсні; ІВ – імпульсні виходи

Вибір технічних засобів:

1. Сигналізація рівня LE за допомогою поплавкових сигналізаторів рівня. Два вхідні дискретні сигнали (01).
2. Вимірювання температури TE за допомогою термопари з вихідним сигналом 4-20мА та діапазоном вимірювання 0-2000С.

Вхідний сигнал аналоговий (02).

1. Клапани КЛ1, КЛ2, КЛ4 та КЛ5 дискретні, електромеханічні. Чотири вихідні дискретні сигнали (01, 02, 04).
2. Управління насосами М за допомогою електромагнітного пускача. Вихідні сигнали дискретні (04).
3. Кнопка «ПУСК» SB. Вхідний сигнал дискретний 03.
4. Клапан КЛ3 пневматичний клапан з електропневматичним аналоговим перетворювачем. Управляючий сигнал 4-20мА. Аналоговий вихід 02.

Виходячи з аналізу спрощеної схеми автоматизації для управління даним об'єктом необхідно сконфігурувати МПК який змоде забезпечити підключення: 3 вхідні дискретні сигнали, 6 вихідних дискретних сигнали, 1 аналоговий вхід та 1 аналоговий вихід.

2.2.2. Конфігурування МПК і схеми підключення зовнішніх пристроїв

Для реалізації алгоритму управління можна вибрати модель MODICON M340 BMX P34 2000 за наступною конфігурацією:

Модулі базового комплекту: BMX CPS 2000, P34 2000.

1 модуль змішаних дискретних сигналів DDM 16025 на 8 входів та 8 виходів.

1 модуль змішаних аналогових сигналів AMM 0600 на 4 аналогових входи та 2 виходи.

Шасі BME XBP 0400 на 4 слоти з вбудованим ETHERNET.

![Image alt](https://github.com/danya-andrienko/Project-Industrial-controllers-and-their-software/blob/main/Рисунки/КонфігураціяПЛК.jpg)


Рис.2.2 – Конфігурація контролера

Конфігурація контролера окрім процесорного модуля та блоку живлення включає в себе модуль дискретного вводу виводу DMM16025, який розташовано на першій позиції та включає в себе 8 дискретних входів 24 VDC, позитивна логіката 8 релейних дискретних виходів VDC/VAC, незахищені, 2 Ата модуль аналогового вводу виводу AMM0600 який розташовано на другій позиції та включає в себе 4 аналогових входи ±10В, 0…10В, 0…5В, 0…20мА, 4…20 мА14-бітні для U, 12-бітні для I, загальна точка, час опитування модуля - 5 мс та два аналогових виходи ±10В,0…20мА,4…20 мА 12-бітні для U, 11-бітні для I, загальна точка. На рисунку 2.3 та 2.4 відповідно зображені конфігурації даних модулів.

![Image alt](https://github.com/danya-andrienko/Project-Industrial-controllers-and-their-software/blob/main/Рисунки/КонфігураціяДискретна.jpg)

Рис.2.3 – Конфігурація модуля дискретних сигналів DMM16025

![Image alt](https://github.com/danya-andrienko/Project-Industrial-controllers-and-their-software/blob/main/Рисунки/КонфігураціяАналогова.jpg)

Рис.2.3 – Конфігурація модуля аналогових сигналів AMM0600

![Image alt](https://github.com/danya-andrienko/Project-Industrial-controllers-and-their-software/blob/main/Рисунки/конфігураціяCPU.jpg)

Рис.2.4 – Конфігурація процесорного модуля

**3.Розроблення схеми підключення датчиків, виконавчих механізмів та інших пристроїв**

Для розробки загальної схеми підключення необхідно розробити схеми підключення окремих модулів МПК. У даній системі для підключення дискретних входів та виходів було використано модуль змішаних дискретних сигналів DDM 16025 схему підключення якого показано на рисунку 3.1.

![Image alt](https://github.com/danya-andrienko/Project-Industrial-controllers-and-their-software/blob/main/Рисунки/Схема_дискретна.jpg)

Рис.3.1 – Схема підключення дискретних сигналів

Для підключення аналогових входів та виходів було використано модуль змішаних аналогових сигналів AMM 0600 схему підключення якого показано на рисунку 3.2.

![Image alt](https://github.com/danya-andrienko/Project-Industrial-controllers-and-their-software/blob/main/Рисунки/Схемааналогова.jpg)

Рис.3.2 – Схема підключення аналогових сигналів

У якості процесорного модуля було використано MODICON M340 P34 2000, з блоком живлення BMX CPS 2000, до якого пд'єднані модулі аналогових та дискретних сигналів. Загальну схему пдключення показано на рисунку 3.3.

![Image alt](https://github.com/danya-andrienko/Project-Industrial-controllers-and-their-software/blob/main/Рисунки/Схема_загальна.jpg)

Рис.3.3 – Загальна схема підключення

**4.**** Складання таблиці зовнішніх змінних та наведення конфігурацій каналів.**

Адреси входів-виходів М340

| Вхідні канали |
| --- | --- | --- | --- |
| Джерело сигналу | Позначення СА | Назва в ПЛК | Адреса |
| Сигналізатор рівня | LE | LE_min | %I0.1.1 |
| Сигналізатор рівня | LE | LE_max | %I0.1.2 |
| Кнопка «ПУСК» | SB | PUSK | %I0.1.0 |
| Датчик температури | TE | TE_IN | %IW0.2.0 |
| Вихідні канали |
| Джерело сигналу | Позначення СА | Назва в ПЛК | Адреса |
| Насос 1 | Дв1 | M1 | %Q0.1.20 |
| Насос 2 | Дв 2 | M2 | %Q0.1.21 |
| Клапан подачі молока | Кл1 | KL1 | %Q0.1.16 |
| Клапан подачі молока | Кл2 | KL2 | %Q0.1.17 |
| Клапан подачі гарячого повітря | Кл3 | KL3_out | %QW0.2.4 |
| Клапан подачі холодного повітря | Кл4 | KL4 | %Q0.1.18 |
| Клапан зливу молока | Кл5 | KL5 | %Q0.1.19 |


**5. Розробка прикладного програмного забезпечення для реалізації алгоритму управління**

Контролери серії MODICONM340 програмуються за допомогою програмного забезпечення UNITYPROXL. Для полегшення орієнтації в програмі вона була розділена на чотири під-програми. Оскільки задача являє собою покроковий алгоритм для його реалізації було обрано тому функціональних блоків FBD.

Програма користувача складається з таких під-програм:

- Programm основна програма у якій відбувається ініціалізація кроків;
- analog_variable у даній програмі відбувається масштабування всіх аналогових сигналів;
- PID_controler програма реалізації регулювання температури;
- аlarm програма реалізації алгоритму дій у випадку аварії.

Лістинг під-програми Programm наведено на рисунку 5.1.

![](RackMultipart20230218-1-la4iis_html_f046972c5950510d.png)

Рис.5.1 – Лістинг під-програми Programm

Під-програма Programm працює наступним чином:

- У першому кроці змінна Step\_Prog порівнюється з 0 і у випадку істини сигнал з блоку порівняння EQ2 йде на блок AND3, який дасть сигнал 1 на вихід лише тоді коли на всіх входах буде 1. Блок AND3 має три входи на перший вхід подається сигнал з блоку EQ2, на другий подується сигнал з кнопки PUSK а на третій вхід, який є інверсним подається сигнал Alarm\_M1 який сигналізує про наявність або відсутність аварії. У випадку коли блок AND3на вихід дасть сигнал 1, цей сигнал піде на блоки MOVE4 таRS\_0. У блоці сигнал під'єднано до входу EN а на вході IN подана 1, яка буде присвоєна змінній Step\_Prog і спричинить перехід до наступного кроку. У блоці RS\_0 сигнал з блоку AND3 під'єднано до входу S та відкриває клапан подачі молока KL1 до апарату.
- У другому кроці програми відбувається закриття клапану KL1 та відкриття клапану KL3 на 50%. На початку кроку стоїть блок EQ5 у якому порівнюється значення Step\_Prog та 1 у разі істини сигнал з цього блоку іде на наступний блок AND6 який має три входи до двох останніх під'єднані сигналізатори верхнього та нижнього рівня відповідно LE\_max та LE\_min і по досягненню верхнього рівня при умові спрацювання блоку EQ5 сигнал пуде далі блок MOVE7 котрий присвоює значення 50.0 зміннй KL3\_SCALE цим самим відкриваючи його на 50% та на вхід R блоку RS\_0 та на наступний блок AND18 який має два входи до другого входу під'єднано вихід блоку EQ19 у якому порівнюється значення ступеня відкриття клапану KL3\_SCALE зі значенням 50% якщо це істина тоді спрацює блок AND який під'єднано до блоку MOVE8 котрий присвоює змінній Step\_Prog значення 2, цим самим ініціалізуючи перехід до наступного кроку.
- У третьому кроці відбувається витримка температури в апараті. При значенні 2 змінної Step\_Prog блок EQ9 подасть позитивний сигнал на вихід цим самим розпочавши даний крок. Сигнал з блоку EQ9 йде на вхід EN блокуGE13 у якому порівнюється значення температури а саме коли температура буде дорівнювати або перевищувати значення 150.0 вихід даного блоку буде активним і сигнал з нього піде до наступного блоку. При досягненні температури 150.0 почнеться відлік часу у таймері TON\_0, після того як час спрацювання таймеру буде рівний часу що заданий на вході РТ вихід набуде значення 1, цим самим активізує блок MOVE11 який присвоює змінній Step\_Prog значення 3.
- В останньому четвертому кроці відбувається процес сушіння. За активацію цього кроку відповідає блок EQ12 який прирівнює значення Step\_Prog зі значенням 3 у разі істини цей блок видає 1 на вихід котрий під'єднано до блоку AND17, який має два входи, другий вхід має інверсію KL5, тобто якщо спрацювала аварія і клапан KL5 процес не продовжиться доки це клапан це закриється. Коли блок AND17 матиме 1 на виході, який під'єднано до входів S блоків RS\_1 вмикає М1, RS\_2 вмикає М2, RS\_3 вмикає KL2, RS\_4 вмикає KL4. Блок AND14 призначений для вимкнення всіх виходів, які були ввімкнені в цьому блоці та для того щоб цикл почав повторюватись. Вихід даного блоку під'єднано до входу R блоків RS\_1 вмикає М1, RS\_2 вмикає М2, RS\_3 вмикає KL2, RS\_4 вмикає KL4 та до входів EN блоків MOVE10 закриває KL3\_SCALE та MOVE15 присвоює 0 змінній Step\_Prog. Блок AND14 має три входи до першого з яких під'єднано вихід блоку AND17 два інші входи інвверні та до них під'єднано відповідно LE\_min та Alarm\_M1, тобто програма завершиться тоді коли апарат буде пустий та буде відсутня аварі мотору М1.

Підпрограма analog\_variable показана на рисунку 5.2.

![](RackMultipart20230218-1-la4iis_html_9a1cb31fdf9fb7ff.png)

Рис.5.2 – Підпрограма analog\_variable

Підпрограма analog\_variable працює наступним чином:

- Блок INT\_TO\_REAL передає сигнал з датчика температури TE\_IN на блок SCALING\_TE, який масштабує вхідне значення з датчика у необхідні межі виміру а саме 0-2000С.
- Блок SCALING\_KL3 призначений для масштабування керуючого сигналу на аналоговий клапан KL3\_out.

Під-програму PID\_controlerпоказано на рисунку 5.3.

![](RackMultipart20230218-1-la4iis_html_c9e627fe5928f78e.png)

Рис.5.3 – Під-програма PID\_controler

Під-програма PID\_controler працює наступним чином:

- Регулятор починає працювати тоді коли Step\_prog, що під'єднано до першого входу блоку EQ1 дорівнює 3.
- Сигнал з блоку EQ1 йде на вхід EN блоку PI\_B, у даному блоці відбувається регулювання. За режим регулювання відповідає змінна TIC\_MAN яка під'єднана до входу MAN\_AUTO та перемикає режим з ручного на автоматичний, до входу PV під'єднана змінна TE\_SCALE яка передає на регулятор плинне значення температури, на вхід SP під'єднана змінна TIC\_SP, що відповідає за уставку регулятора, на вхід PARA під'єднана змінна PARA\_TE, у якій задані значення масштабування та складових регулятора, на вхід OUT під'єднано змінну KL3\_SCALE, яка є масштабованою змінною аналогового клапану.
- Блоки MOVEу даній підпрограмі призначені для передавання та зміни значень параметрів регулятора зі SCADA-системи.

Підпрограму alarm показано на рисунку 5.4.

![](RackMultipart20230218-1-la4iis_html_46701a8541af9565.png)

Рис.5.4 – Підпрограма alarm

Підпрограма alarm працює наступним чином:

- Програма починає працювати тоді коли Step\_prog, що під'єднано до першого входу блоку EQ1 дорівнює 3.
- Сигнал з блоку EQ1 йде на вхід блоку XOR3 до другого входу якого під'єднано сигнал з мотору М1, виходячи з цього вихід даного блоку буде активним тоді коли лише один вхід буде активним а це можливо лише у двох випадках коли М1 активний а вхід до якого під'єднано вихід блоку EQ1 або ж навпаки коли М1 буде не активним а вихід блоку EQ1 буде активним.
- Сигнал з блоку XOR3 вмикає змінну Alarm\_M1 та вимикає мотор М2 і закриває клапани KL2, KL3, KL4, вмикає клапан KL5 та вимикає програму доки аварія не зникне.

**6.**** Розроблення імітатора об'єкта**

Імітатор об'єкта призначений для перевірки правильності розробленої програми перед введенням її безпосередньо на об'єкті. Імітатор об'єкта в даному випадку складається з двох підпрограм а саме: simulation\_le та simulation\_input.

Підпрограма simulation\_le показана на рисунку 6.1.

![](RackMultipart20230218-1-la4iis_html_4386199399ad357c.png)

Рис.6.1 – Підпрограма simulation\_le

Підпрограма simulation\_le працює наступним чином:

- Набір рівня відбувається при умові якщо рівень в апараті SIM\_LE менше або рівний 100.0 та відкритий клапан KL1 тобто максимальний рівень який може бути 100.1;
- Спуск рівня відбувається у двох випадках якщо відкритий клапан KL5 та SIM\_LE більше 0.0 або ж якщо увімкнені мотори М1, М2 та відкритий клапан KL2 при умові що рівень SIM\_LE більше 0.0.

Підпрограма simulation\_input показана на рисунку 6.2.

![](RackMultipart20230218-1-la4iis_html_f636129673612c7c.png)

Рис.6.2 – Підпрограма simulation\_input

Підпрограма simulation\_input складається з трьох незалежних блоків, саме тут відбувається імітація роботи всіх датчиків.

У першому блоці відбувається симуляція роботи датчика температури, працює це наступним чином: до входу блоку INT\_TO\_REAL1 під'єднано не масштабовану змінну температури TE\_IN вихід блоку під'єднано до блоку MUL2 у якому відбувається множення значення змінної на 0,97 після чого значення йде на один з входів блоку ADD4 у якому це значення сумується зі значенням ще одного блоку MUL3 у якому відбувається множення значення відкриття клапану KL3\_SCALE на 0.5, після додавання цих значень вихідна величина передається на блок REAL\_TO\_INT6 вихід з якого під'єднано до блоку WRITE\_TO\_INPUT\_INT5 на виході якого вказана змінна температури TE\_IN таким чином відбувається симуляція температури.

У другому блоці відбувається симуляція спрацювання сигналізаторів рівня, яка реалізована за допомогою логічних операцій. Симуляція спрацювання нижнього рівня відбувається наступним чином: до блоку RS\_7 під'єднано два блоки на вхід S блок GE7 у якому відбувається порівняння рівня SIM\_LE зі значенням 0.1 у випадку якщо SIM\_LE більше або рівний 0.1 вихід стане активним та увімкне сигналізатор, до входу R під'єднано блок LT11 у якому відбувається порівняння значення рівня SIM\_LE зі значенням 0.1 та у випадку якщо SIM\_LE менше вихід стане активним і сигнал з блоку вимкне сигналізатор рівня. На вихід блоку RS\_7 під'єднано блок WRITE\_INPUT\_EBOOL8 на виході якого і знаходиться змінна, що відповідає за сигналізатор рівня LE\_min. Симуляція спрацювання верхнього сигналізатора рівня відбувається аналогічним чино за винятком значення спрацювання для блоків GE8 та LT12 вони становлять 99.0 та 100.0 відповідно.

Третій блок призначений для передавання змінних до мнемосхеми оператора реалізовано це за допомогою блоків MOVE.

1. **Відлагодження програми користувача.**

Відлагодження програми відбувається в три етапи:

- Перед впровадженням на об'єкт
- Доводка програми на об'єкті перед пуском
- Доводка програми на об'єкті в режимі експлоатації

Під час першого етапу розробнику ПЗ не потрібно бути на об'єкті, необхідно лише створити ПЗ для імітації об'єкту яке буде максимально наближено імітувати технологічний процес.

У програмному середовищі UNITY PRO імітацію вхідних сигналів можна проводити за допомогою функції WRITE\_TO\_INPUT цим методом можна імітувати натискання кнопок та спрацювання датчиків. Для спостереженням за зміною значень змінних можна створити операторський екран або таблицю анімації приклад таблиці анімації показано на рисунку 7.1.

![](RackMultipart20230218-1-la4iis_html_a55108ceb274796d.png)

Рис.7.1 – Таблиця анімації змінних

У таблиці анімації можна спостерігати за змінними при відлагодженні проекту також для більшого наближення до реального об'єкту створено програму імітації об'єкту, що описана у попередньому пункті.

У якості операторського екрану було створено SCADA-систему у програмному середовищі CitectSCADAтаблицю змінних SCADA-системи наведено у таблиці 7.1.

Таблиця 7.1 – Таблиця змінних SCADA-системи

| Назва в SCADA | Тип змінної | Адреса в ПЛК | За що відповідає |
| --- | --- | --- | --- |
| PUSK | DIGITAL | %M102 | Кнопка ПУСК |
| KL1 | DIGITAL | %M104 | Клапан подачі молока 1 |
| KL2 | DIGITAL | %M105 | Клапан подачі молока 2 |
| KL3 | REAL | %MW200 | Клапан подачі гарячого повітря |
| KL4 | DIGITAL | %M106 | Клапан подачі холодного повітря |
| KL5 | DIGITAL | %M107 | Клапан зливу молока |
| M1 | DIGITAL | %M111 | Насос 1 |
| M2 | DIGITAL | %M112 | Насос 2 |
| TE\_R | REAL | %MW204 | Плинне значення температури |
| Alarm\_M1 | DIGITAL | %M110 | Сигнал аварійної зупинки насосу 1 |
| SIM\_ALM | DIGITAL | %M109 | Симуляція аварії |
| LE | REAL | %MW202 | Симуляція рівня |
| LE\_MIN | DIGITAL | %M101 | Сигналізатор нижнього рівня |
| LE\_MAX | DIGITAL | %M108 | Сигналізатор верхнього рівня |
| TIC\_MAN | DIGITAL | %M115 | Режим регулювання |
| TIC\_SP | REAL | %MW206 | Уставка регулятора |
| TIC\_MAN\_REG | REAL | %MW100 | Зміна уставки регулятора |
| TIC\_KP | REAL | %MW20 | Зміна коефіцієнту пропорційності регулятора |
| TIC\_TI | ULONG | %MW10 | Зміна часу інтегрування регулятора |

Візуалізація проекту розроблена за стилем sxw\_stule\_1 у якому передбачено створення декількох сторінок з різними параметрами. Окрім створених автоматичним шляхом, було також створено сторінку налаштувань регулятора «Регулятор температури» яку зображено на рисунку 7.2, та модифіковано сторінку «Startub» яку зображено на рисунку 7.3 та на якій зобрашений об'єкт для якого розроблялось дане ПЗ.

![](RackMultipart20230218-1-la4iis_html_43b04c2f0f406a0a.png)

Рис.7.2 – Сторінка «Регулятор температури»

![](RackMultipart20230218-1-la4iis_html_72d725b2cd7190d7.png)

Рис.7.3 – Сторінка «Startub»